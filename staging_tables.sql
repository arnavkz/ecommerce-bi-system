CREATE OR REPLACE DATABASE IMT577_DW_ARNAV_KULKARNI_STAGE

CREATE OR REPLACE WAREHOUSE "IMT577_DW_ARNAV_KULKARNI_STAGE" WITH WAREHOUSE_SIZE='XSMALL' AUTO_SUSPEND=600 AUTO_RESUME=TRUE COMMENT='';

CREATE OR REPLACE STAGE "IMT 577_DW_ARNAV_KULKARNI_STAGE"."PUBLIC"."STAGE_ITSESSION"

CREATE OR REPLACE FILE FORMAT CSV_SKIP_HEADER
type= 'CSV'
field_delimiter=','
FIELD_OPTIONALLY_ENCLOSED_BY='"'
skip_header=1;

CREATE OR REPLACE FILE FORMAT CSV_SKIP_HEADER_DATE
type = 'CSV'
FIELD_OPTIONALLY_ENCLOSED_BY = '"'
skip_header = 1
DATE_FORMAT = 'MM/DD/YY';

CREATE OR REPLACE TABLE STAGE_CHANNEL (
  CHANNELID INTEGER,
  CHANNELCATEGORYID INTEGER,
  CHANNEL VARCHAR(200),
  CREATEDDATE TIMESTAMP_NTZ(9),
  CREATEDBY VARCHAR(16777216),
  MODIFIEDDATE VARCHAR(16777216),
  MODIFIEDBY VARCHAR(16777216)
);

CREATE OR REPLACE TABLE STAGE_CHANNELCATEGORY (
    CHANNELCATEGORYID INTEGER,
  CHANNELCATEGORY VARCHAR(200),
  CREATEDDATE TIMESTAMP_NTZ(9),
  CREATEDBY VARCHAR(16777216),
  MODIFIEDDATE VARCHAR(16777216),
  MODIFIEDBY VARCHAR(16777216)
);

CREATE OR REPLACE TABLE STAGE_CUSTOMER (
  CUSTOMERID VARCHAR(16777216),
  SUBSEGMENTID INTEGER,
  FIRSTNAME VARCHAR(16777216),
  LASTNAME VARCHAR(16777216),
  GENDER VARCHAR(16777216),
  EMAILADDRESS VARCHAR(16777216),
  ADDRESS VARCHAR(16777216),
  CITY VARCHAR(16777216),
  STATEPROVINCE VARCHAR(16777216),
  COUNTRY VARCHAR(16777216),
  POSTALCODE INTEGER,
  PHONENUMBER VARCHAR(16777216),
  CREATEDDATE TIMESTAMP_NTZ(9),
  CREATEDBY VARCHAR(16777216),
  MODIFIEDDATE VARCHAR(16777216),
  MODIFIEDBY VARCHAR(16777216)
);

CREATE OR REPLACE TABLE STAGE_PRODUCT (
  PRODUCTID INTEGER,
  PRODUCTTYPEID INTEGER,
  PRODUCT VARCHAR(16777216),
  COLOR VARCHAR(16777216),
  STYLE VARCHAR(16777216),
  UNITOFMEASUREID INTEGER,
  WEIGHT NUMBER(38,3),
  PRICE NUMBER(38,3),
  COST NUMBER(38,3),
  CREATEDDATE TIMESTAMP_NTZ(9),
  CREATEDBY VARCHAR(16777216),
  MODIFIEDDATE VARCHAR(16777216),
  MODIFIEDBY VARCHAR(16777216),
  WHOLESALEPRICE NUMBER(38,3)
);

CREATE OR REPLACE TABLE STAGE_PRODUCTCATEGORY (
  PRODUCTCATEGORYID INTEGER,
  PRODUCTCATEGORY VARCHAR(200),
  CREATEDDATE TIMESTAMP_NTZ(9),
  CREATEDBY VARCHAR(16777216),
  MODIFIEDDATE VARCHAR(16777216),
  MODIFIEDBY VARCHAR(16777216)
);

CREATE OR REPLACE TABLE STAGE_PRODUCTTYPE (
  PRODUCTTYPEID INTEGER,
  PRODUCTCATEGORYID INTEGER,
  PRODUCTTYPE VARCHAR(200),
  CREATEDDATE TIMESTAMP_NTZ(9),
  CREATEDBY VARCHAR(16777216),
  MODIFIEDDATE VARCHAR(16777216),
  MODIFIEDBY VARCHAR(16777216)
);

CREATE OR REPLACE TABLE STAGE_RESELLER (
  RESELLERID VARCHAR(16777216),
  CONTACT VARCHAR(16777216),
  EMAILADDRESS VARCHAR(16777216),
  ADDRESS VARCHAR(16777216),
  CITY VARCHAR(16777216),
  STATEPROVINCE VARCHAR(16777216),
  COUNTRY VARCHAR(16777216),
  POSTALCODE INTEGER,
  PHONENUMBER VARCHAR(16777216),
  CREATEDDATE TIMESTAMP_NTZ(9),
  CREATEDBY VARCHAR(16777216),
  MODIFIEDDATE VARCHAR(16777216),
  MODIFIEDBY VARCHAR(16777216),
  RESELLERNAME VARCHAR(16777216)
);

CREATE OR REPLACE TABLE STAGE_SALESDETAIL (
  SALESDETAILID INTEGER,
  SALESHEADERID INTEGER,
  PRODUCTID INTEGER,
  SALESQUANTITY INTEGER,
  SALESAMOUNT NUMBER(38,2),
  CREATEDDATE TIMESTAMP_NTZ(9),
  CREATEDBY VARCHAR(16777216),
  MODIFIEDDATE VARCHAR(16777216),
  MODIFIEDBY VARCHAR(16777216)
);

CREATE OR REPLACE TABLE STAGE_SALESHEADER_NEW (
  SALESHEADERID INTEGER,
  DATE DATE,
  CHANNELID INTEGER,
  STOREID VARCHAR(16777216),
  CUSTOMERID VARCHAR(16777216),
  RESELLERID VARCHAR(16777216),
  CREATEDDATE TIMESTAMP_NTZ(9),
  CREATEDBY VARCHAR(16777216),
  MODIFIEDDATE VARCHAR(16777216),
  MODIFIEDBY VARCHAR(16777216)
);

CREATE OR REPLACE TABLE STAGE_SEGMENT (
  SEGMENTID INTEGER,
  SEGMENT VARCHAR(16777216),
  CREATEDDATE TIMESTAMP_NTZ(9),
  CREATEDBY VARCHAR(16777216),
  MODIFIEDDATE TIMESTAMP_NTZ(9),
  MODIFIEDBY VARCHAR(16777216)
);

CREATE OR REPLACE TABLE STAGE_STORE (
  STOREID INTEGER,
  SUBSEGMENTID INTEGER,
  STORENUMBER INTEGER,
  STOREMANAGER VARCHAR(16777216),
  ADDRESS VARCHAR(16777216),
  CITY VARCHAR(16777216),
  STATEPROVINCE VARCHAR(16777216),
  COUNTRY VARCHAR(16777216),
  POSTALCODE INTEGER,
  PHONENUMBER VARCHAR(16777216),
  CREATEDDATE TIMESTAMP_NTZ(9),
  CREATEDBY VARCHAR(16777216),
  MODIFIEDDATE VARCHAR(16777216),
  MODIFIEDBY VARCHAR(16777216)
);

CREATE OR REPLACE TABLE STAGE_TARGETDATA_CHANNELRESELLERANDSTORE (
  YEAR INTEGER,
  CHANNELNAME VARCHAR(16777216),
  TARGETNAME VARCHAR(16777216),
  TARGETSALESAMOUNT INTEGER
);

CREATE OR REPLACE TABLE STAGE_TARGETDATA_PRODUCT (
  PRODUCTID INTEGER,
  PRODUCT VARCHAR(16777216),
  YEAR INTEGER,
  SALESQUANTITYTARGET INTEGER
);


SELECT * FROM STAGE_SEGMENT;

SELECT * FROM STAGE_STORE;

SELECT * FROM STAGE_CHANNELCATEGORY;
